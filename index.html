<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fly.</title>
    <!-- Load Tailwind CSS for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use the Inter font for a clean, modern look -->
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
      body {
          font-family: 'Inter', sans-serif;
          /* Custom radial gradient background for the lunar-purple and pink effect */
          background: radial-gradient(circle at center, #FBCFE8 0%, #E9D5FF 50%, #A855F7 100%);
      }

      /* Custom CSS for the liquid glass effect */
      .liquid-glass {
        background: rgba(255, 255, 255, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.3);
        backdrop-filter: blur(10px);
        box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1);
      }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <!-- Main container for the liquid glass search interface -->
    <div id="search-container" class="p-8 md:p-12 rounded-3xl liquid-glass shadow-2xl w-full max-w-2xl text-center transition-all duration-500">
        <!-- Title of the application -->
        <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-6">Fly.</h1>
        <p class="text-lg md:text-xl text-gray-600 mb-8">Enter a URL to get started.</p>
        
        <!-- Search bar container -->
        <div class="flex flex-col sm:flex-row items-center justify-center space-y-4 sm:space-y-0 sm:space-x-4">
            <!-- Search input field -->
            <input 
                id="search-input" 
                type="text" 
                placeholder="https://example.com" 
                class="w-full sm:flex-1 px-6 py-4 rounded-full border border-gray-300 bg-white bg-opacity-30 focus:outline-none focus:ring-4 focus:ring-purple-300 focus:border-transparent transition-all duration-300 text-gray-700 placeholder-gray-400 text-lg"
            >
            
            <!-- Search button -->
            <button 
                id="search-button" 
                class="w-full sm:w-auto px-8 py-4 rounded-full bg-purple-600 text-white font-bold text-lg shadow-lg hover:bg-purple-700 focus:outline-none focus:ring-4 focus:ring-purple-300 transition-transform duration-300 transform hover:scale-105 active:scale-95"
            >
                Go
            </button>
        </div>
    </div>

    <!-- Toolbar to appear above the iframe -->
    <div id="toolbar" class="fixed top-0 left-0 w-full px-4 py-2 liquid-glass z-20 hidden">
      <div class="flex items-center space-x-4">
          <!-- Back to search button -->
          <button 
              id="search-back-button" 
              class="px-4 py-2 rounded-full bg-gray-500 text-white text-sm shadow-lg hover:bg-gray-600 focus:outline-none focus:ring-4 focus:ring-gray-300 transition-transform duration-300 transform hover:scale-105 active:scale-95"
          >
              Back
          </button>
          <!-- History navigation buttons -->
          <button 
              id="history-back-button" 
              class="w-10 h-10 flex items-center justify-center rounded-full bg-gray-500 text-white text-lg shadow-lg hover:bg-gray-600 focus:outline-none focus:ring-4 focus:ring-gray-300 transition-transform duration-300 transform hover:scale-105 active:scale-95"
          >
              <!-- Back arrow SVG icon -->
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
              </svg>
          </button>
          <button 
              id="history-forward-button" 
              class="w-10 h-10 flex items-center justify-center rounded-full bg-gray-500 text-white text-lg shadow-lg hover:bg-gray-600 focus:outline-none focus:ring-4 focus:ring-gray-300 transition-transform duration-300 transform hover:scale-105 active:scale-95"
          >
              <!-- Forward arrow SVG icon -->
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
              </svg>
          </button>
          <!-- Current URL display -->
          <span id="current-url" class="text-gray-800 text-sm font-bold truncate max-w-[calc(100%-16rem)]"></span>
      </div>
    </div>

    <!-- Iframe to display the loaded content -->
    <iframe id="content-iframe" class="fixed top-0 left-0 w-screen h-screen border-none hidden"></iframe>

    <!-- JavaScript for handling the URL and iframe functionality -->
    <script>
        // Get references to the main elements
        const searchInput = document.getElementById('search-input');
        const searchButton = document.getElementById('search-button');
        const searchContainer = document.getElementById('search-container');
        const toolbar = document.getElementById('toolbar');
        const contentIframe = document.getElementById('content-iframe');
        const searchBackButton = document.getElementById('search-back-button');
        const historyBackButton = document.getElementById('history-back-button');
        const historyForwardButton = document.getElementById('history-forward-button');
        const currentUrlSpan = document.getElementById('current-url');

        // Function to check if a string is a valid URL
        function isValidUrl(string) {
            try {
                // Prepend 'https://' if no protocol is found to help with validation
                const fullUrl = string.startsWith('http') ? string : `https://${string}`;
                new URL(fullUrl);
                return true;
            } catch (e) {
                return false;
            }
        }

        // Function to handle loading the content in the iframe
        function processUrl(url) {
            if (url === '') {
                return;
            }
            
            // Check if the input is a valid URL
            if (isValidUrl(url)) {
                // Hide the main search container and show the iframe and toolbar
                searchContainer.classList.add('hidden');
                toolbar.classList.remove('hidden');
                contentIframe.classList.remove('hidden');
                
                // Set the iframe source using the hash format
                contentIframe.src = `/s/embed.html#${encodeURIComponent(url)}`;
                currentUrlSpan.textContent = url;
            } else {
                // If not a valid URL, display a message
                console.log("Please enter a valid URL.");
            }
        }

        // Add event listener to the "Go" button
        searchButton.addEventListener('click', () => {
            const inputValue = searchInput.value.trim();
            processUrl(inputValue);
        });

        // Add an event listener for the 'Enter' key
        searchInput.addEventListener('keydown', (event) => {
            if (event.key === 'Enter') {
                const inputValue = searchInput.value.trim();
                processUrl(inputValue);
            }
        });

        // Add event listener to the "Back" button to return to the search screen
        searchBackButton.addEventListener('click', () => {
            // Hide the toolbar and iframe and show the search container
            toolbar.classList.add('hidden');
            contentIframe.classList.add('hidden');
            searchContainer.classList.remove('hidden');
            // Clear the iframe src to stop any content loading
            contentIframe.src = '';
            // Clear the input field for a new search
            searchInput.value = '';
        });

        // Add event listener for the history back button
        historyBackButton.addEventListener('click', () => {
            window.history.back();
        });

        // Add event listener for the history forward button
        historyForwardButton.addEventListener('click', () => {
            window.history.forward();
        });
    </script>
</body>
</html>
